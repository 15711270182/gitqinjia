<!DOCTYPE html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="divport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0" />
    <meta name="divport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=0">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="format-detection" content="telephone=no">
    <title>金币</title>

   
    <script type="text/javascript" src="/static/website/js/jquery-1.11.3.min.js"></script>
    <script type="text/javascript" src="/static/website/js/autosize.js?v=1"></script>
    <!--<script src="http://res.wx.qq.com/open/js/jweixin-1.6.0.js"></script>-->
 
    <style type="text/css">
       *{margin: 0;padding: 0;}
        html,body{width:100%; height: 100%;}
        a{text-decoration:none;color: #ffffff;}
        #contenter{margin: 0 auto;height:100%;position: relative;font-family:arial;}
       
        #header{height: 4.731rem;background-color: #333231;padding: 0px 0.912rem;display:flex;justify-content: space-between;align-items:center;}
		#header .l{width:12rem; position: relative;height: 2.85rem;}
		#header .l .i{width: 2.565rem;height: 2.394rem;float:left;margin:0.2rem 0rem;}
		#header .l .i img{width: 2.565rem;height: 2.394rem;}
		#header .l .m{width: 2.565rem;height: 2.85rem;float:left;text-indent:0.5rem;}
		#header .l .t{color: rgba(255,255,255,0.4);font-size: 0.684rem;font-weight: 400;width: max-content;height: 1.254rem;line-height:  1.254rem;}
		#header .l .b{ color: #FFE0A2;;font-size: 1.596rem;height: 1.596rem;line-height: 1.596rem;font-weight: 600;}
		#header .r{width: 3rem;height: 1.026rem;line-height: 1.026rem;color: #C8C9CC;font-size: 0.741rem;font-weight: 400;}
		
		#tips{width:19.551rem;line-height:1.254rem;background: rgba(255, 137, 19, 0.12);border-radius:0.684rem;color: #FF8913;font-weight: 400;font-size: 0.741rem;padding: 0.627rem 0.855rem;margin: 0.912rem auto 0rem;}
		
		#content{width: 100%;padding: 0rpx 0.57rem; height: 9.405rem;overflow-y: hidden; overflow-x: auto;margin:0 auto;}
		#content .content{height:9.405rem;margin: 1.14rem 0.4rem 1.71rem;}
		#content .content .li{width: 5.7rem;margin: 0px 0.342rem;border: 1px solid #C8C9CC;border-radius:  0.684rem; height:6.555rem; display: flex;flex-direction: column;align-items: center;float: left;}
		#content .content .li .restrictions{height: 2.565rem; }
		#content .content .li .restrictions .t{width: 2.964rem; height: 1.311rem;line-height: 1.311rem;border-radius:0.66rem;font-size: 0.627rem;color: #FF8913;font-weight: 400;background-image: url("https://resource.njweiyi2.com/6.30.10.png");background-size: 100% 100%;text-align: center;margin:0.912rem auto 0.342rem;}
		#content .content .on{position: relative;border: 1px solid #333231;box-shadow: 0px 8px 16px 0px rgba(0, 0, 0, 0.04);}
		#content .content .on::before{content: "";position: absolute;z-index: 1;width:  1.14rem;height:  1.14rem;right: -1px;bottom: -1px; background-image: url("http://small.ying-ji.com/bojinzhilian/identity_check_icon.png?v=1");background-size: 100% 100%;}
		#content .content .li .num{height: 1.482rem;display: flex;justify-content: center;align-items: center;}
		#content .content .li .num .i{width: 0.912rem;height: 0.912rem;background-image: url("https://resource.njweiyi2.com/6.10.9.png");background-size: 100% 100%;}
		#content .content .li .num .t{line-height: 1.482rem;color: #FF8913;font-size: 1.026rem;font-weight: 700;margin: 0rpx 0rpx 0rpx 0.228rem;}
		#content .content .li .money{height: 1.596rem;line-height: 1.596rem;width: max-content;color: #949699;font-size:  0.684rem;font-weight: 400;}
		#content .content .li .money span{font-size: 0.912rem;}
		#line{height: 2.964rem;width:19.551rem;position: relative;margin:0 auto;}
		#line::before{content: "";position: absolute;z-index: 1;top: 0.741rem;left: 0; width: 7.353rem;height: 1px;background: linear-gradient(to left, #C8C9CC 0%,#ffffff 100%);}
		#line::after{content: "";position: absolute;z-index: 1;top: 0.741rem;right: 0; width:7.353rem;height: 1px;background: linear-gradient(to right, #C8C9CC 0%,#ffffff 100%);}
		#line .t{color: #333231;line-height: 1.482rem;font-size: 0.912rem;font-weight: 600; width: max-content;position: relative;margin: 0 auto;}
		#line .t::before{content: "";position: absolute;z-index: 2;left: -0.741rem;top: 0.684rem;width: 0.228rem;height: 0.228rem;background-color: #333231;border-radius: 0.114rem;}
		#line .t::after{content: "";position: absolute;z-index: 2;right: -0.741rem;top: 0.684rem;width: 0.228rem;height: 0.228rem;background-color: #333231;border-radius: 0.114rem;}
		#list{width: 19.665rem;display: flex;flex-wrap: wrap;padding: 5rpx 0rpx 0.855rem;margin:0 auto;}
		#list .item{width: 6.555rem;display: flex;flex-direction: column;align-items: center;}
		#list .item .icon{width: 2.85rem;height: 3.021rem;padding: 2px 0rpx;}
		#list .item .icon img{width: 2.85rem;height: 2.85rem;}
		#list .item .name{color: #54545B;;font-size: 0.798rem;height: 1.71rem;line-height: 48rpx;padding: 0.342rem 0rpx 0rpx; text-align: center;font-family: DINPro-Medium;font-weight: 600;}
		#list .item .desc{color: #949699;font-size:  0.684rem;text-align: center;height: 2.394rem;line-height:  1.254rem;font-weight: 400;}
		#btn{position:fixed;z-index:1;left:0;right:0;bottom:2.28rem; width: 16.53rem;height: 2.736rem; text-align: center;line-height: 2.736rem;border-radius: 2.736rem; background-color: #222533;font-size: 0.912rem;font-weight: 400;margin:0 auto;}
		#btn text{color: #FFE0A2;}
    </style>
</head>
<body>
<div id="contenter">
	
    <div id="header">			
		<div class="l">
			<div class="i">
				<img src="https://resource.njweiyi2.com/6.30.8.png"/>
			</div>
			<div class="m">
				<div class="t">金币余额</div>
				<div class="b">{$data.score_total}</div>
			</div>
			
		</div>
		<div class="r"><a href="/love_h5/web/goldExplain" >购买须知</a></div>
	</div>
	{if $data.is_switch == 0}
	<div id="tips">{$data.editor1}</div>
	{/if}
	<div id="content">
		<div class="content" style="width:33rem;">

			{foreach $data.list as $k=>$v}
			<div class="li {$k== $data.detail_on ?'on':''}" onclick="show(this)" on="{$k + 1}" money="{$v.money}" pay_type="{$v.id}">
				<div class="restrictions">
					<div class="t">{$v.discount_desc}</div>
				</div>
				<div class="num">
					<div class="i"></div>
					<div class="t">{$v.score_num}</div>
				</div>
				<div class="money">￥<span>{$v.money}</span></div>
			</div>
			{/foreach}
		</div>
	</div>
		
	<div id="line">
		<div class="t">金币作用</div>
	</div>
	<div id="list">
		<div class="item">
			<div class="icon"><img src="https://resource.njweiyi2.com/6.30.11.png"/></div>
			<div class="name">解锁聊天</div>
			<div class="desc">解锁聊天不受限</div>
		</div>
		<div class="item">
			<div class="icon"><img src="https://resource.njweiyi2.com/6.30.12.png"/></div>
			<div class="name">超级喜欢</div>
			<div class="desc">解锁超级喜欢</div>
		</div>
		<div class="item">
			<div class="icon"><img src="https://resource.njweiyi2.com/6.30.13.png"/></div>
			<div class="name">谁喜欢我</div>
			<div class="desc">解锁喜欢我的人</div>
		</div>
		<div class="item">
			<div class="icon"><img src="https://resource.njweiyi2.com/6.30.14.png"/></div>
			<div class="name">来访</div>
			<div class="desc">解锁来访嘉宾</div>
		</div>
		<div class="item">
			<div class="icon"><img src="https://resource.njweiyi2.com/6.30.15.png"/></div>
			<div class="name">查看更多</div>
			<div class="desc">可以查看更多嘉宾</div>
		</div>
		<div class="item">
			<div class="icon"><img src="https://resource.njweiyi2.com/6.30.16.png"/></div>
			<div class="name">要Ta微信</div>
			<div class="desc">解锁高级嘉宾</div>
		</div>
	</div>
	<div style="height:8rem;"></div>
	<div id="btn">
		<text>¥<span>9.9</span>&nbsp;&nbsp;购买金币</text>			
	</div>
</div>
<script>

    var on = '{$data.detail_on}';      //默认选择值
	var money = $('.on').attr('money');    //金额
	var uid = getQueryStringByName('uid');
	var openid = getQueryStringByName('openid');
	var collect = "{$Think.get.collect|default='11'}";

	$('#btn span').html(money);
	
    //选项切换
	function show(e){
	
		on    = $(e).attr("on");
		money = $(e).attr("money");
		
		$(".li").attr("class","li");	
		$(e).attr("class","li on");
			
		$("#btn span").html(money);

		
	}

	// 开通会员
	$("#btn").one("click", function () {
		var type = $('.on').attr("pay_type");

		// if(2 == is_pay){
		// 	is_pay = 1;
			$.ajax({
				'url': '/apinew/v1/score/payScoreH5?uid=' + uid + "&score_type=" + type+"&openid="+openid+"&collect="+collect,
				'dataType': 'json',
				success: function (result) {

					var res  = JSON.parse(result);
					let code = res.errcode;
					if(200 != code){
						alert(res.errmsg);
						setTimeout(() => {
							window.location.reload();
						}, 1000);
						return;
					}

					if (typeof WeixinJSBridge == "undefined") {
						if (document.addEventListener) {
							document.addEventListener('WeixinJSBridgeReady', onBridgeReady, false);
						} else if (document.attachEvent) {
							document.attachEvent('WeixinJSBridgeReady', onBridgeReady);
							document.attachEvent('onWeixinJSBridgeReady', onBridgeReady);
						}
					} else {
						onBridgeReady(res);
					}
				},
				error: function (e) { }
			});
		// }


	})
	function getQueryStringByName(name) {
		var result = window.location.search.match(new RegExp("[\?\&]" + name + "=([^\&]+)", "i"));
		if (result == null || result.length < 1) {
			return "";
		}
		return result[1];
	}

	function onBridgeReady(res) {
		res = res.data
		WeixinJSBridge.invoke(
				'getBrandWCPayRequest', {
					appId: res.data.appId, //公众号名称，由商户传入
					timeStamp: res.data.timeStamp, //时间戳，自1970年以来的秒数
					nonceStr: res.data.nonceStr, //随机串
					package: res.data.package, //prepay_id用等式的格式
					signType: res.data.signType, //微信签名方式：
					paySign: res.data.paySign, //微信签名
				}, function (resa) {
					setTimeout(() => {
						window.location.reload();
					}, 1000);
				})
	}


</script>
</body>
</html>

